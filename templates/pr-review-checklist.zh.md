# Pull Request 审查清单

> **语言 (Language)**: [English](pr-review-checklist.md) | 简体中文

使用此清单确保全面的代码审查。在审查时勾选项目。

---

## 审查前

- [ ] PR 有清晰、描述性的标题
- [ ] PR 描述解释了做什么和为什么（而不仅仅是如何做）
- [ ] PR 链接到相关的问题
- [ ] PR 大小合理（首选 < 400 行更改）
- [ ] CI/CD 检查通过
- [ ] 与目标分支没有合并冲突

---

## 代码质量

### 功能性

- [ ] 代码实现了 PR 描述中声称的功能
- [ ] 链接问题的所有验收标准都已满足
- [ ] 边缘情况得到适当处理
- [ ] 错误处理全面且适当
- [ ] 没有明显的错误或逻辑错误

### 代码风格

- [ ] 遵循项目编码标准
- [ ] 与现有代码库风格一致
- [ ] 没有不必要的代码复杂性
- [ ] 遵循 DRY 原则（没有不必要的重复）
- [ ] 在适用的情况下遵循 SOLID 原则

### 命名和可读性

- [ ] 变量和函数具有清晰、描述性的名称
- [ ] 布尔变量使用 is/has/should 前缀
- [ ] 没有魔法数字（常量已命名）
- [ ] 代码是自文档化的
- [ ] 复杂逻辑有解释性注释

### 架构和设计

- [ ] 更改与现有架构很好地契合
- [ ] 没有违反关注点分离
- [ ] 依赖项适当且最小
- [ ] 没有引入紧耦合
- [ ] 考虑了可扩展性

---

## 测试

### 测试覆盖率

- [ ] 新代码有相应的测试
- [ ] 测试覆盖正常路径
- [ ] 测试覆盖边缘情况和错误条件
- [ ] 测试覆盖率达到项目阈值（例如 >80%）
- [ ] 没有在没有理由的情况下删除测试

### 测试质量

- [ ] 测试清晰且命名良好
- [ ] 测试遵循 AAA 模式（Arrange-Act-Assert）
- [ ] 测试是独立的（没有测试相互依赖）
- [ ] 没有不稳定或依赖时间的测试
- [ ] 模拟/存根的使用是适当的

### 手动测试

- [ ] 更改已经过手动测试
- [ ] 提供了测试说明（如果适用）
- [ ] UI 更改包含截图/视频
- [ ] 在多个环境中测试（如果适用）

---

## 安全性

### 输入验证

- [ ] 所有用户输入都已验证
- [ ] 有 SQL 注入预防措施
- [ ] Web 输出有 XSS 预防措施
- [ ] 命令注入预防
- [ ] 路径遍历保护

### 认证和授权

- [ ] 存在认证检查
- [ ] 授权检查正确
- [ ] 没有权限提升漏洞
- [ ] 会话管理是安全的

### 数据保护

- [ ] 敏感数据未被记录
- [ ] 密钥未硬编码
- [ ] 在适当的地方使用加密
- [ ] 个人数据处理符合法规（GDPR 等）

### 依赖项

- [ ] 没有带有已知漏洞的新依赖项
- [ ] 依赖项来自可信来源
- [ ] 依赖项版本已固定或受约束

---

## 性能

### 效率

- [ ] 没有明显的性能瓶颈
- [ ] 数据库查询已优化
- [ ] 没有 N+1 查询问题
- [ ] 适当使用缓存
- [ ] 循环中没有不必要的计算

### 资源管理

- [ ] 防止内存泄漏
- [ ] 文件句柄/连接正确关闭
- [ ] 大型数据集处理高效
- [ ] 在适当的地方使用异步操作

### 可扩展性

- [ ] 代码可以处理预期负载
- [ ] 没有会在规模上造成问题的硬编码限制
- [ ] 资源使用是合理的

---

## 文档

### 代码文档

- [ ] 公共 API 有文档注释
- [ ] 复杂算法有解释
- [ ] "为什么"注释解释了不明显的决定
- [ ] 没有注释掉的代码（除非有解释）

### 项目文档

- [ ] 如果需要更新 README
- [ ] API 文档已更新
- [ ] CHANGELOG 已更新
- [ ] 为破坏性更改提供迁移指南

### 用户文档

- [ ] 用户面向的更改已记录
- [ ] 如果适用，帮助文本已更新
- [ ] 发布说明已准备

---

## 数据库和迁移

- [ ] 迁移是可逆的
- [ ] 迁移在生产数据副本上测试
- [ ] 迁移中没有数据丢失
- [ ] 在适当的地方添加索引
- [ ] 迁移性能可接受

---

## API 更改

- [ ] 保持向后兼容性（或记录破坏性更改）
- [ ] API 版本控制使用正确
- [ ] 请求/响应模式已记录
- [ ] 错误响应是一致的
- [ ] 考虑了速率限制

---

## UI/UX（如果适用）

- [ ] UI 符合设计规范
- [ ] 响应式设计在所有目标设备上工作
- [ ] 满足可访问性标准（WCAG）
- [ ] 加载状态得到处理
- [ ] 错误消息对用户友好
- [ ] 考虑了国际化

---

## Git 和提交

### 提交质量

- [ ] 提交是逻辑性和原子性的
- [ ] 提交消息遵循约定
- [ ] 没有合并提交（如果是 rebase 工作流）
- [ ] 没有应该被压缩的提交

### 分支管理

- [ ] 分支与目标保持最新
- [ ] 没有提交不必要的文件
- [ ] 如果需要更新 .gitignore

---

## 部署

- [ ] 对有风险的更改使用功能标志
- [ ] 部署计划已记录
- [ ] 存在回滚计划
- [ ] 环境变量已记录
- [ ] 配置更改已注明

---

## 按语言/框架的特定检查

### JavaScript/TypeScript

- [ ] TypeScript 类型正确（没有滥用 `any`）
- [ ] Promise 处理正确（没有未处理的拒绝）
- [ ] async/await 使用正确
- [ ] 避免来自闭包的内存泄漏

### Python

- [ ] 使用类型提示（如果适用）
- [ ] 异常处理适当
- [ ] 对资源使用上下文管理器
- [ ] PEP 8 合规性

### Java

- [ ] 异常处理适当
- [ ] 资源正确关闭（try-with-resources）
- [ ] 考虑了线程安全
- [ ] 没有明显的内存泄漏

### Go

- [ ] 错误处理遵循 Go 约定
- [ ] Goroutine 不会泄漏
- [ ] Defer 语句使用适当
- [ ] Context 用于取消

---

## 最终检查

- [ ] 没有未提交问题的 TODO 注释
- [ ] 没有留下调试代码
- [ ] 没有 console.log/print 语句（除非是有意的）
- [ ] 构建成功
- [ ] 所有测试通过
- [ ] Linter 通过
- [ ] 没有引入新的警告

---

## 审查结果

### 批准 ✅

使用时机：

- 所有关键项目已检查
- 次要建议可以在后续中解决
- 更改提高了代码库质量

### 请求更改 🔄

使用时机：

- 关键问题必须修复
- 存在安全漏洞
- 测试不足
- 破坏性更改未正确记录

### 评论 💬

使用时机：

- 只是提供反馈
- 不阻止批准
- 询问澄清性问题

---

## 审查评论最佳实践

### 建设性

```
❌ "这段代码很糟糕"
✅ "考虑将其提取到单独的函数中以提高可测试性"
```

### 具体明确

```
❌ "改进错误处理"
✅ "在第 45 行周围添加 try-catch 以处理潜在的 JSON 解析错误"
```

### 解释原因

```
❌ "不要这样做"
✅ "这种方法可能导致 N+1 查询。考虑改用急切加载。"
```

### 建议解决方案

```
❌ "这行不通"
✅ "当 X 发生时这可能会失败。考虑改用 Y 模式。示例：[代码]"
```

### 认可好的工作

```
✅ "很好的重构！这更易读。"
✅ "边缘情况的测试覆盖很好。"
```

---

## 严重程度级别

### 🔴 关键（必须修复）

- 安全漏洞
- 数据丢失风险
- 没有迁移路径的破坏性更改
- 主要性能回归

### 🟡 重要（应该修复）

- 缺少测试
- 代码质量问题
- 小的性能问题
- 不清楚的文档

### 🟢 次要（最好有）

- 风格偏好
- 优化机会
- 替代方法

### 💡 建议（可选）

- 未来改进
- 额外功能
- 学习资源

---

## 时间指南

- **小型 PR（< 100 行）**: 10-15 分钟
- **中型 PR（100-400 行）**: 30-45 分钟
- **大型 PR（> 400 行）**: 60+ 分钟（或请求拆分）

如果审查时间更长，请考虑：

- PR 太大（请求拆分）
- 需要更多上下文（提出问题）
- 改为结对编程会话

---

## 审查后

### 对于审查者

- [ ] 跟进请求的更改
- [ ] 更改后重新审查
- [ ] 满意时批准

### 对于作者

- [ ] 处理所有评论
- [ ] 如果需要请求澄清
- [ ] 将对话标记为已解决
- [ ] 准备好时请求重新审查

---

## 注意事项

**记住:**

- 审查是关于代码，而不是人
- 当你不理解时提出问题
- 可以从 PR 中学习
- 审查者和作者都对质量负责

**代码审查的目标:**

1. 捕获错误和问题
2. 维护代码质量
3. 分享知识
4. 确保一致性
5. 改善团队协作

---

## 自定义说明

为您的项目调整此清单：

1. 删除不适用的部分
2. 添加项目特定的检查
3. 调整严重程度定义
4. 更新特定语言的部分
5. 添加公司/团队政策
6. 包含指向风格指南的链接

**保存为**: `.github/PULL_REQUEST_TEMPLATE/review-checklist.md` 或保存在 docs/ 中
